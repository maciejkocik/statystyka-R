---
title: "Praca domowa - podstawy grafiki"
author: "Bartosz Makiewicz"
output: html_document
editor_options: 
  chunk_output_type: console
---

# Zadanie 1

Hoaglin, Mosteller i Tukey (1983) zebrali dane na temat poziomu beta-endorfin we krwi jako funkcji stresu. Zmierzyli poziomy beta-endorfin 19 pacjent贸w 12 godzin przed stresujc operacj oraz 10 minut przed operacj. Obserwacje znajduj si w pliku `hoaglin1983.csv` i podane s w jednostkach fmol/ml.

## Zadanie A

Przygotuj dwa histogramy ilustrujcy rozkad wartoci w obu pomiarach. Nie zapomnij o nao偶eniu na wykres legendy oraz podpis贸w osi. Co mo偶esz na podstawie tych dw贸ch histogram贸w wywnioskowa?

```{r}
pomiary <- read.csv("dane/hoaglin1983.csv")

par(mfrow = c(1, 2))

hist(pomiary$X12_hours, col="blue", main = "12 godzin przed operacj", xlab="", ylab = "Czsto", breaks=10)

hist(pomiary$X10_minutes, col="red", main = "10 minut przed operacj", xlab="", ylab = "Czsto", breaks=10)

mtext("Poziom beta-endorfin we krwi", side = 1, line = -2, outer = TRUE)
legend("topright", c("12h przed", "10min przed"), col=c("blue", "red"), lwd=10)

```

**Wnioski:**

Na podstawie tych diagram贸w mo偶na wywnioskowa, 偶e poziom beta-endorfin we krwi 10 minut przed operacj by og贸lnie wy偶szy ni偶 12 godzin przed operacj. U 2 pacjent贸w stres przed operacj by zauwa偶alnie wy偶szy, gdy偶 poziom beta-endorfin we krwi osign u nich wynik rzdu 40-50 fmol/ml. Diagramy te nie m贸wi nam jednak nic o tym, jak zwiksza/zmniejsza si poziom stresu, gdy偶 nie ma na nich ukazanej r贸偶nicy u poszczeg贸lnych pacjent贸w, a jedynie wartoci przed/po w caej grupie.

## Zadanie B

Przygotuj wykres pudekowy (`boxplot`), wykres supkowy (`barplot`) wykres skrzypcowy (`vioplot` z pakietu `vioplot`) ilustrujce ksztat rozkadu obserwacji w obu pomiarach. Postaraj si, aby oba zbiory danych byy na jednym wykresie (czyli narysuj 3 wykresy, a nie 6). Nie zapomnij o nao偶eniu na wykres legendy oraz podpis贸w osi oraz wybraniu adnych kolor贸w. Co mo偶esz wywnioskowa na podstawie poszczeg贸lnych wykres贸w? Jak r贸偶ni si od siebie te trzy metody wizualizacji w tym wypadku?

```{r}
library(vioplot)
par(mfrow=c(1,2), xpd=TRUE)
boxplot(pomiary$X12_hours, col="hotpink", main = "12 godzin przed operacj")
boxplot(pomiary$X10_minutes, col= "cyan3", main = "10 minut przed operacj")
legend(0.8, 0, c("12h przed", "10min przed"), col=c("hotpink", "cyan3"), lwd=10)
mtext("Poziom beta-endorfin we krwi", side = 1, line = -2, outer = TRUE)


barplot(pomiary$X12_hours, col="deeppink", main = "12 godzin przed operacj")
barplot(pomiary$X10_minutes, col="dodgerblue", main = "10 minut przed operacj")
legend(7, -3.5, c("12h przed", "10min przed"), col=c("deeppink", "dodgerblue"), lwd=10)
mtext("Poziom beta-endorfin we krwi", side = 1, line = -2, outer = TRUE)


vioplot(pomiary$X12_hours, col="maroon1", main = "12 godzin przed operacj")
vioplot(pomiary$X10_minutes, col="royalblue", main = "10 minut przed operacj")
legend(0.8, 0, c("12h przed", "10min przed"), col=c("maroon1", "royalblue"), lwd=10)
mtext("Poziom beta-endorfin we krwi", side = 1, line = -2, outer = TRUE)


```

**Wnioski:**

Wedug mnie, najprostszy do odczytania jest wykres pudekowy. Mo偶emy na nim atwo zauwa偶y na przykad, 偶e mediana poziomu beta-endorfin we krwi jest mniejsza 10 minut przed operacj oraz 偶e wystpuj w tym zbiorze dwie wartoci odstajce. Na wykresie supkowym wartoci te te偶 s widoczne, natomiast ci偶ej jest odczyta z niego co o medianie i kwartylach. Wykres skrzypcowy jest dla mnie troch mao czytelny, ale mo偶e po prostu musz nauczy si go odczytywa 

## Zadanie C

Odejmij od wartoci z kolumny z poziomem beta-endorfin 12 godzin przed operacj wartoci 10 minut przed operacj. Uzyskany wektor bdzie zawiera r贸偶nice midzy tymi pomiarami dla ka偶dego badanego. Narysuj histogram i zinterpretuj go. Nie zapomnij o nao偶eniu na wykres legendy oraz podpis贸w osi

```{r}
par(mfrow=c(1,1))

diff <- pomiary$X12_hours - pomiary$X10_minutes

bins <- seq(min(diff)-1,
            max(diff)+1, 
            by=1 
            )

hist(diff, col="paleturquoise3", breaks = bins, main = "R贸偶nica poziomu beta-endorfin pomidzy pomiarami", xlab = "R贸偶nica poziomu beta-endorfin we krwi", ylab = "Czsto")

legend("topright", "R贸znica", col="paleturquoise3", lwd=10)
```

**Wnioski:**

U wikszoci pacjent贸w r贸偶nica poziomu beta-endorfin we krwi bya bardzo niewielka (w okolicach 0), lecz w niekt贸rych przypadkach wzr贸s on nawet o 40 fmol/ml, co mo偶e sugerowa, 偶e pacjenci stresuj si bardziej 10 minut przed operacj ni偶 12 godzin przed. Uwa偶am, 偶e lepsze byoby zastosowanie tutaj wykresu pudekowego (boxplot), aby sensowniej zinterpretowa dane.

# Zadanie 2

Wiemy, 偶e palenie tytoniu odpowiada za wiele negatywnych skutk贸w dla ludzkiego zdrowia. Istniej pewne empiryczne wiadectwa, 偶e wpywa r贸wnie偶 na podno. Weinberg i Gladen (1986, `weinberg1986.csv`) przebadali skutki palenia na atwo zachodzenia kobiet w ci偶. W tym celu wzili pr贸b 586 kobiet, kt贸re planoway ci偶e i zapytali jak wiele cykli miesiczkowych upyno od odstawienia antykoncepcji zanim zaszy w ci偶. Badacze podzielili r贸wnie偶 kobiety na dwie grupy - palce i niepalce.

## Zadanie A

Przygotuj wykres supkowy (*stacked barplot*), skadajcy si z dw贸ch kolumn. Jedna odpowiada ma kobietom palcym, druga kobietom niepalcym. Segmenty ka偶dej z kolumn maj odpowiada proporcji kobiet w danej grupie, dla kt贸rych od zakoczenia antykoncepcji do zajcia w ci偶e upyn 1 cykl, 2 cykle i 3+ cykle. Do opracowania statystycznego danych przydadz si funkcje `table` oraz `prop.table`. Wykres stworzy mo偶na korzystajc z funkcji `barplot`. Nie zapomnij o nao偶eniu na wykres legendy oraz podpis贸w osi, spr贸buj r贸wnie偶 wybra czytelne kolory dla poszczeg贸lnych segment贸w. Co mo偶esz stwierdzi na podstawie takiego wykresu?

```{r}
palenie <- read.csv("dane/weinberg1986.csv")

par(mfrow=c(1,1))

barplot(prop.table(table(palenie$Cycles, palenie$Smoking), 2),
        horiz=TRUE,
        col= c("lightsalmon", "mediumpurple", "palegreen"),
        main="Ilo cykli miesiczkowych od zakoczenia antykoncepcji do ci偶y",
        xlab="Czsto (w %)",
        legend=TRUE)
```

**Wnioski:**

Na podstawie wykresu mog stwierdzi, 偶e u kobiet niepalcych atwiejsze byo zajcie w ci偶. Ponad poowa kobiet palcych zachodzia w ci偶 dopiero po ponad 3 cyklach miesiczkowych, natomiast u kobiet niepalcych odsetek ten wynosi niecae 40%.

## Uwagi:

W zadaniach 1A i 1B zrezygnowaem z podpisania osi X na wykresach na rzecz jednego podpisu na dole caej "figure", poniewa偶 w ten spos贸b wykresy s moim zdaniem czytelniejsze.
